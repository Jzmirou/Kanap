(()=>{var j=Object.defineProperty;var I=(i,t,e)=>t in i?j(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var P=(i,t,e)=>(I(i,typeof t!="symbol"?t+"":t,e),e),T=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var q=(i,t,e)=>(T(i,t,"read from private field"),e?e.call(i):t.get(i)),E=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},Q=(i,t,e,r)=>(T(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e);var y=class{cart;constructor(){if(localStorage.getItem("cart")){let t=JSON.parse(localStorage.getItem("cart"));this.cart=t}else this.cart=[]}addCart=(t,e,r=1)=>{let n=Number(r);if(n<=0)throw new Error("on ne peux pas ajout\xE9 0 ou moins en quantit\xE9");let s=this.cart.find(o=>o.id===t&&o.color===e);if(s){let o=s.quantity+n;this.checkMaxProduct(t,e,r),s.quantity=o}else this.cart.push({id:t,quantity:n,color:e});this.save(),console.log("Produit ajout\xE9")};removeCart=(t,e,r)=>{let n=this.findProduct(t,e);if(!n)throw new Error("Le produit n'est pas le panier, il ne peux pas \xEAtre supprim\xE9");let s=Number(n.quantity),o=Number(r)||s;if(s===o){let c=this.cart.findIndex(u=>u.id===t&&u.color===e);this.cart.splice(c,1)}else n.quantity-=o;this.save(),console.log("Produit supprim\xE9")};save=()=>{let t=JSON.stringify(this.cart);localStorage.setItem("cart",t)};findProduct=(t,e)=>this.cart.find(r=>r.id===t&&r.color===e);getCartProductIds=()=>{let t=new Set;for(let e of this.cart)t.add(e.id);return[...t]};isCartEmpty=()=>!this.cart||this.cart.length===0;checkMaxProduct=(t,e,r)=>{let n=this.findProduct(t,e);if(!n)return;let s=100,o=Number(n.quantity)+r,c=s-Number(n.quantity);if(Number(n.quantity)>=s)throw new Error("La quantit\xE9 maximal pour ce produit est atteint");if(o>s)throw new Error(`Quantit\xE9 maximal atteint, quantit\xE9 restante: ${Math.abs(s-n.quantity)}`)}};var a=(i,t={})=>{let e=document.createElement(i);for(let[r,n]of Object.entries(t))e.setAttribute(r,n);return e};var k="http://localhost:3000/api",O=async(i,t={})=>{let e=await fetch(`${k}${i}`,{...t,headers:{Accept:"application/json",...t.headers}});if(!e.ok)throw new Error(`Pas de r\xE9ponse du serveur ! status: ${e.status}`,{cause:e});return await e.json()};var N=async i=>await O(`/products/${i}`,{method:"GET"});var v=class{#t;constructor(){let t=a("p");t.style.fontSize="1.5rem",t.style.fontWeight="bold",t.innerText="LOADING ...",this.#t=t}get element(){return this.#t}};var m=class extends Error{constructor(t){super(),this.message=t,this.name=""}};var f,g=class{constructor(t,e,r){E(this,f,void 0);let n=a("article"),s=a("div",{class:"item__img"}),o=a("img",{src:e.imageUrl,alt:e.altTxt}),c=a("div",{class:"item__content"}),u=a("div",{class:"item__content__titlePrice"}),d=a("h1",{id:"title"});d.innerText=e.name;let l=a("p",{id:"price"});l.innerText=`Prix : ${e.price} \u20AC`;let p=a("div",{class:"item__content__description"}),b=a("p",{class:"item__content__description__title"});b.innerText="Description :";let C=a("p",{id:"description"});C.innerText=e.description;let x=new _(e),S=new w(e._id,x.itemQuantity,x.itemColor,r);Q(this,f,t),q(this,f).append(n),n.append(s),s.append(o),n.append(c),c.append(u),c.append(p),c.append(x.element),c.append(S.element),u.append(d),u.append(l),p.append(b),p.append(C)}},h=g;f=new WeakMap,P(h,"initialize",async(t,e,r)=>{try{let n=new v().element;t.append(n);let s=await N(e);return n.remove(),new g(t,s,r)}catch(n){console.error(n)}});var _=class{#t;itemQuantity;itemColor;constructor(t){let e=a("div",{class:"item__content__settings"}),r=a("div",{class:"item__content__settings__color"}),n=a("label",{for:"color-select"});n.innerText="Choisir une couleur :";let s=a("select",{name:"color-select",id:"colors"}),o=a("option",{value:""});o.innerText="--SVP, choisissez une couleur --";let c=a("div",{class:"item__content__settings__quantity"}),u=a("label",{for:"itemQuantity"});u.innerText="Nombre d'article(s) (1-100) :";let d=a("input",{type:"number",name:"itemQuantity",min:"1",max:"100",value:"0",id:"quantity"});e.append(r),e.append(c),r.append(n),r.append(s),c.append(u),c.append(d),s.append(o);for(let l of t.colors){let p=a("option",{value:`${l}`});p.innerText=l,s.append(p)}this.#t=e,this.itemQuantity=d,this.itemColor=s}get element(){return this.#t}},w=class{#t;productId;inputs;Cart;constructor(t,e,r,n){let s=a("div",{class:"item__content__addButton"}),o=a("button",{id:"addToCart"});o.innerText="Ajouter au panier",o.addEventListener("click",this.handleClick),s.append(o),this.#t=s,this.productId=t,this.inputs={itemQuantity:e,itemColor:r},this.Cart=n;for(let[c,u]of Object.entries(this.inputs))u.addEventListener("input",d=>{try{this.validation(u)}catch{}})}get element(){return this.#t}handleClick=()=>{let t=this.inputs.itemColor.value,e=Number(this.inputs.itemQuantity.value),r=this.productId,[n,s]=this.checkValidation([this.itemColor,this.itemQuantity]),o=document.querySelector("#errorMessageProduct")||a("p",{id:"errorMessageProduct",style:"font-size: 1.5rem; font-weight: 'bold'; text-align: center;"});if(!n){o.innerText=s.message,this.element.insertAdjacentElement("afterend",o);return}o.innerText="Produit ajout\xE9 au panier",this.Cart.addCart(r,t,e),this.element.insertAdjacentElement("afterend",o),setTimeout(()=>o.innerText="",1500)};checkValidation=t=>{let e,r=this.inputs.itemColor.value,n=Number(this.inputs.itemQuantity.value),s=this.productId;try{let o=!1;for(let[c,u]of Object.entries(this.inputs)){let[d,l]=this.validation(u);!d&&!o&&(o=l)}if(o)throw new Error(o);return this.Cart.checkMaxProduct(s,r,n),[e=!0,void 0]}catch(o){return[e=!1,o]}};validation=t=>{let e=t.value,r;try{switch(t.id){case"colors":if(!e||e.trim()==="")throw new m("Veuillez choisir une couleur");break;case"quantity":if(!Number(e)||Number(e)===0)throw new m("Veuillez choisir une quantit\xE9");if(Number(e)<0)throw new m("Quantit\xE9 n\xE9gative non autoris\xE9")}return t.style.border="none",[r=!0,void 0]}catch(n){return t.style.border="2px solid red",[r=!1,n]}}};var A=document.querySelector("#item"),V=new URLSearchParams(window.location.search),z=V.get("id"),M=async()=>{try{await h.initialize(A,z,new y)}catch(i){console.error(i)}};M();})();
//# sourceMappingURL=product.js.map
