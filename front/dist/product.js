(()=>{var j=Object.defineProperty;var I=(i,t,e)=>t in i?j(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var T=(i,t,e)=>(I(i,typeof t!="symbol"?t+"":t,e),e),P=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var q=(i,t,e)=>(P(i,t,"read from private field"),e?e.call(i):t.get(i)),E=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},Q=(i,t,e,o)=>(P(i,t,"write to private field"),o?o.call(i,e):t.set(i,e),e);var y=class{cart;constructor(){if(localStorage.getItem("cart")){let t=JSON.parse(localStorage.getItem("cart"));this.cart=t}else this.cart=[]}addCart=(t,e,o=1)=>{let r=Number(o);if(r<=0)throw new Error("on ne peux pas ajout\xE9 0 ou moins en quantit\xE9");let s=this.cart.find(n=>n.id===t&&n.color===e);if(s){let n=s.quantity+r;this.checkMaxProduct(t,e,o),s.quantity=n}else this.cart.push({id:t,quantity:r,color:e});this.save(),console.log("Produit ajout\xE9")};removeCart=(t,e,o)=>{let r=this.findProduct(t,e);if(!r)throw new Error("Le produit n'est pas le panier, il ne peux pas \xEAtre supprim\xE9");let s=Number(r.quantity),n=Number(o)||s;if(s===n){let c=this.cart.findIndex(u=>u.id===t&&u.color===e);this.cart.splice(c,1)}else r.quantity-=n;this.save(),console.log("Produit supprim\xE9")};save=()=>{let t=JSON.stringify(this.cart);localStorage.setItem("cart",t)};findProduct=(t,e)=>this.cart.find(o=>o.id===t&&o.color===e);getCartProductIds=()=>{let t=new Set;for(let e of this.cart)t.add(e.id);return[...t]};isCartEmpty=()=>!this.cart||this.cart.length===0;checkMaxProduct=(t,e,o)=>{let r=this.findProduct(t,e);if(!r)return;let s=100,n=Number(r.quantity)+o,c=s-Number(r.quantity);if(Number(r.quantity)>=s)throw new Error("La quantit\xE9 maximal pour ce produit est atteint");if(n>s)throw new Error(`Quantit\xE9 maximal atteint, quantit\xE9 restante: ${Math.abs(s-r.quantity)}`)}};var a=(i,t={})=>{let e=document.createElement(i);for(let[o,r]of Object.entries(t))e.setAttribute(o,r);return e};var k="http://localhost:3000/api",O=async(i,t={})=>{let e=await fetch(`${k}${i}`,{...t,headers:{Accept:"application/json",...t.headers}});if(!e.ok)throw new Error(`Pas de r\xE9ponse du serveur ! status: ${e.status}`,{cause:e});return await e.json()};var N=async i=>await O(`/products/${i}`,{method:"GET"});var v=class{#t;constructor(){let t=a("p");t.style.fontSize="1.5rem",t.style.fontWeight="bold",t.innerText="LOADING ...",this.#t=t}get element(){return this.#t}};var p=class extends Error{constructor(t){super(),this.message=t,this.name=""}};var f,g=class{constructor(t,e,o){E(this,f,void 0);let r=a("article"),s=a("div",{class:"item__img"}),n=a("img",{src:e.imageUrl,alt:e.altTxt}),c=a("div",{class:"item__content"}),u=a("div",{class:"item__content__titlePrice"}),l=a("h1",{id:"title"});l.innerText=e.name;let d=a("p",{id:"price"});d.innerText=`Prix : ${e.price} \u20AC`;let m=a("div",{class:"item__content__description"}),b=a("p",{class:"item__content__description__title"});b.innerText="Description :";let C=a("p",{id:"description"});C.innerText=e.description;let x=new w(e),S=new _(e._id,x.itemQuantity,x.itemColor,o);Q(this,f,t),q(this,f).append(r),r.append(s),s.append(n),r.append(c),c.append(u),c.append(m),c.append(x.element),c.append(S.element),u.append(l),u.append(d),m.append(b),m.append(C)}},h=g;f=new WeakMap,T(h,"initialize",async(t,e,o)=>{let r=new v().element;t.append(r);try{let s=await N(e);return r.remove(),new g(t,s,o)}catch(s){r.remove(),console.error(s);let n=a("p");n.style.fontSize="20px",n.innerText="Nous sommes d\xE9sol\xE9 nous rencontrons des probl\xE8mes avec le serveur",t.append(n)}});var w=class{#t;itemQuantity;itemColor;constructor(t){let e=a("div",{class:"item__content__settings"}),o=a("div",{class:"item__content__settings__color"}),r=a("label",{for:"color-select"});r.innerText="Choisir une couleur :";let s=a("select",{name:"color-select",id:"colors"}),n=a("option",{value:""});n.innerText="--SVP, choisissez une couleur --";let c=a("div",{class:"item__content__settings__quantity"}),u=a("label",{for:"itemQuantity"});u.innerText="Nombre d'article(s) (1-100) :";let l=a("input",{type:"number",name:"itemQuantity",min:"1",max:"100",value:"0",id:"quantity"});e.append(o),e.append(c),o.append(r),o.append(s),c.append(u),c.append(l),s.append(n);for(let d of t.colors){let m=a("option",{value:`${d}`});m.innerText=d,s.append(m)}this.#t=e,this.itemQuantity=l,this.itemColor=s}get element(){return this.#t}},_=class{#t;productId;inputs;Cart;constructor(t,e,o,r){let s=a("div",{class:"item__content__addButton"}),n=a("button",{id:"addToCart"});n.innerText="Ajouter au panier",n.addEventListener("click",this.handleClick),s.append(n),this.#t=s,this.productId=t,this.inputs={itemQuantity:e,itemColor:o},this.Cart=r;for(let[c,u]of Object.entries(this.inputs))u.addEventListener("input",l=>{try{this.validation(u)}catch{}})}get element(){return this.#t}handleClick=()=>{let t=this.inputs.itemColor.value,e=Number(this.inputs.itemQuantity.value),o=this.productId,[r,s]=this.checkValidation([this.itemColor,this.itemQuantity]),n=document.querySelector("#errorMessageProduct")||a("p",{id:"errorMessageProduct",style:"font-size: 1.5rem; font-weight: 'bold'; text-align: center;"});if(!r){n.innerText=s.message,this.element.insertAdjacentElement("afterend",n);return}n.innerText="Produit ajout\xE9 au panier",this.Cart.addCart(o,t,e),this.element.insertAdjacentElement("afterend",n),setTimeout(()=>n.innerText="",1500)};checkValidation=t=>{let e,o=this.inputs.itemColor.value,r=Number(this.inputs.itemQuantity.value),s=this.productId;try{let n=!1;for(let[c,u]of Object.entries(this.inputs)){let[l,d]=this.validation(u);!l&&!n&&(n=d)}if(n)throw new Error(n);return this.Cart.checkMaxProduct(s,o,r),[e=!0,void 0]}catch(n){return[e=!1,n]}};validation=t=>{let e=t.value,o;try{switch(t.id){case"colors":if(!e||e.trim()==="")throw new p("Veuillez choisir une couleur");break;case"quantity":if(!Number(e)||Number(e)===0)throw new p("Veuillez choisir une quantit\xE9");if(Number(e)<0)throw new p("Quantit\xE9 n\xE9gative non autoris\xE9");if(Number(e)>100)throw new p("Vous ne pouvez pas ajouter plus de 100 article")}return t.style.border="none",[o=!0,void 0]}catch(r){return t.style.border="2px solid red",[o=!1,r]}}};var z=document.querySelector("#item"),V=new URLSearchParams(window.location.search),A=V.get("id"),M=async()=>{try{await h.initialize(z,A,new y)}catch(i){console.error(i)}};M();})();
//# sourceMappingURL=product.js.map
